serviceAccount:
  create: false

server:
  nameOverride: vmrules
  fullnameOverride: vmrules
  replicaCount: 1

  # Настройки источника данных
  datasource:
    url: "http://vmsingle.monitoring.svc.cluster.local.:8428"

  # Настройки отправки метрик
  remote:
    write:
      url: "http://vmsingle.monitoring.svc.cluster.local.:8428"

  # Настройки Alertmanager
  notifier:
    alertmanager:
      url: http://alertmanager.monitoring.svc.cluster.local:9093

  # Дополнительные параметры
  extraArgs:
    evaluationInterval: 1m
    external.url: https://vmrules.dev.local
    rule:
    - /rules/*/*.yaml

  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values: [ vmrules ]
        topologyKey: kubernetes.io/hostname

  # Ограничения ресурсов
  resources:
    requests:
      cpu: 15m
      memory: 25M
    limits:
      cpu: 30m
      memory: 100M

  extraVolumes:
  - name: alertmanager-rules
    configMap:
      name: alertmanager-rules
  - name: node-rules
    configMap:
      name: node-rules
  - name: kubernetes-rules
    configMap:
      name: kubernetes-rules
  - name: minio-rules
    configMap:
      name: minio-rules
  - name: certificate-exporter-rules
    configMap:
      name: certificate-exporter-rules

  extraVolumeMounts:
  - name: alertmanager-rules
    mountPath: /rules/alertmanager-rules
  - name: node-rules
    mountPath: /rules/node-rules
  - name: kubernetes-rules
    mountPath: /rules/kubernetes-rules
  - name: minio-rules
    mountPath: /rules/minio-rules
  - name: certificate-exporter-rules
    mountPath: /rules/certificate-exporter-rules

  service:
    enabled: true
    annotations:
      prometheus.io/scrape: "true"
      prometheus.io/port: "8880"

  # Настройки Ingress
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: ca-issuer
    hosts:
    - name: vmrules.dev.local
      path: /
      port: 8880
    tls:
    - secretName: vmalert-tls
      hosts:
      - vmrules.dev.local

alertmanager:
  enabled: false
